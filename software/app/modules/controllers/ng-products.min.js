app.controller('home', home);
app.controller('products', myproducts);
app.controller('inprogress', inprogress);
app.controller('categories', categories);
app.controller('contactus', contactus);

app.controller('singleproduct', singgleProduct);


home.$inject = ['$rootScope', '$scope', 'services', 'Products'];
function home($rs, $s, svc, Products){
	svc.mainMenu(function(m){
		$rs.menu = m;
	},1);

	Products.getLatestProducts({
		"limit": 4
	},function(e, r){
		$s.products = r.data;
	});

	Products.getInProgressProducts({
		"limit": 2
	},function(e, x){
		$s.progressProducts = x.data;
	});
}

myproducts.$inject = ['$rootScope', '$scope', 'services', 'Products'];
function myproducts($rs, $s, svc, Products){
	svc.mainMenu(function(m){
		$rs.menu = m;
	},2);

	Products.getAll({
		"limit": 8
	},function(e, r){
		// console.log(r.data);
		$s.products = r.data;
	});
}

inprogress.$inject = ['$rootScope', '$scope', 'services', 'Products'];
function inprogress($rs, $s, svc, Products){
	svc.mainMenu(function(m){
		$rs.menu = m;
	},3);
	Products.getInProgressProducts({
		limit: 4
	},function(e, r){
		if(r){
			$s.inprogress = r.data;
		}
	});
}

categories.$inject = ['$rootScope', '$scope', 'services'];
function categories($rs, $s, svc){
	svc.mainMenu(function(m){
		$rs.menu = m;
	},5);
}

contactus.$inject = ['$rootScope', '$scope', 'services'];
function contactus($rs, $s, svc){
	svc.mainMenu(function(m){
		$rs.menu = m;
	},6);
}

singgleProduct.$inject = ['$rootScope', '$scope', 'services', 'Products', '$routeParams'];
function singgleProduct($rs, $s, svc, Products, $rp){
	svc.mainMenu(function(m){
		$rs.menu = m;
	},2);
	Products.getProduct($rp.id, {}, function(e, r){
		r.data[0].image1= Products.getImgUrl() + ((r.data[0].image1 === '')?'no-image.png':r.data[0].image1);
		r.data[0].image2= Products.getImgUrl() + ((r.data[0].image2 === '')?'no-image.png':r.data[0].image2);
		r.data[0].image3= Products.getImgUrl() + ((r.data[0].image3 === '')?'no-image.png':r.data[0].image3);
		r.data[0].image4= Products.getImgUrl() + ((r.data[0].image4 === '')?'no-image.png':r.data[0].image4);
		r.data[0].image5= Products.getImgUrl() + ((r.data[0].image5 === '')?'no-image.png':r.data[0].image5);
		// console.log(r.data[0]);
		$s.product = r.data;
	});

	Products.getActiveProducts({
		"limit": 4,
		"key" : "p", /* key dipakai untuk definisi dari excludeId */
		where:{
			"excludeId" : $rp.id
		}
	},function(e, x){
		$s.sideProducts = x.data;
	});
}

